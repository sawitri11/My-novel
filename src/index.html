<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100vw; height: 100vh; overflow: hidden; position: fixed; top: 0; left: 0; }
    body { touch-action: none; overscroll-behavior: none; }
  </style>
  <title>‡∏Ñ‡∏±‡∏°‡∏†‡∏µ‡∏£‡πå‡∏´‡∏°‡∏∑‡πà‡∏ô‡∏≠‡∏±‡∏Å‡∏©‡∏£ - The Jade Scroll</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  
  <!-- CSS Modules -->
  <link href="src/styles/base.css" rel="stylesheet">
  <link href="src/styles/character.css" rel="stylesheet">
  <link href="src/styles/writing.css" rel="stylesheet">
  <link href="src/styles/chapters.css" rel="stylesheet">
  <link href="src/styles/chapter-preview.css" rel="stylesheet">
  <link href="src/styles/world.css" rel="stylesheet">
</head>
<body>
  <div class="app-container">
    <!-- Hamburger Menu Button -->
    <button class="menu-toggle" id="menuToggle">
      <i class="fas fa-bars"></i>
    </button>

    

    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2><i class="fas fa-scroll"></i> ‡∏Ñ‡∏±‡∏°‡∏†‡∏µ‡∏£‡πå‡∏´‡∏°‡∏∑‡πà‡∏ô‡∏≠‡∏±‡∏Å‡∏©‡∏£</h2>
        <button class="sidebar-close" id="sidebarToggle">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="sidebar-menu">
        <div class="module-item active" data-module="writing">
          <i class="fas fa-feather-alt"></i>
          <span>‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô</span>
        </div>
        <div class="module-item" data-module="chapters">
          <i class="fas fa-book-open"></i>
          <span>‡∏Ñ‡∏•‡∏±‡∏á‡∏ö‡∏ó</span>
        </div>
        <div class="module-item" data-module="characters">
          <i class="fas fa-users"></i>
          <span>‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£</span>
        </div>
        <div class="module-item" data-module="world">
          <i class="fas fa-globe"></i>
          <span>‡πÇ‡∏•‡∏Å</span>
        </div>
        <div class="module-item" data-module="structure">
          <i class="fas fa-sitemap"></i>
          <span>‡πÇ‡∏Ñ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</span>
        </div>
        <div class="module-item" data-module="research">
          <i class="fas fa-search"></i>
          <span>‡∏ß‡∏¥‡∏à‡∏±‡∏¢</span>
        </div>
        <div class="module-item" data-module="archive">
          <i class="fas fa-archive"></i>
          <span>‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î</span>
        </div>
      </div>

      <div class="sidebar-footer">
        <div class="status-indicator offline" id="statusIndicator">
          <i class="fas fa-circle"></i>
          <span>‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå</span>
        </div>
      </div>
    </nav>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Main Content Area -->
    <div class="main-content" id="mainContent">
      <!-- Writing Module (Default) -->
      <div class="content-panel active" id="writing-panel">
        <!-- Chapter Cards Trigger -->
        <button class="chapter-cards-trigger" id="chapterCardsTrigger">
          <i class="fas fa-clipboard-list"></i>
        </button>

        <!-- Chapter Info Cards Overlay -->
        <div class="chapter-cards-overlay" id="chapterCardsOverlay">
          <div class="chapter-info-cards" id="chapterInfoCards">
            <!-- Chapter cards will be generated here -->
          </div>
        </div>

        <div class="panel-header">
          <h3><i class="fas fa-feather-alt"></i> ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô</h3>
          <div class="save-status-inline" id="saveStatusInline">
            <span id="saveStatusText">
              <span class="status-dot">üü¢</span>‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô
            </span>
          </div>
          <button class="ai-icon-btn" id="aiAnalyzeBtn" title="‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡πâ‡∏ß‡∏¢ AI">
            <i class="fas fa-brain"></i>
          </button>
        </div>
        
        <div class="writing-area" id="writingArea">
          <div class="infinite-paper-container">
            <textarea class="writing-editor" id="writingEditor" placeholder="‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
          </div>
        </div>
      </div>

      <!-- Chapters Module -->
      <div class="content-panel" id="chapters-panel">
        <div class="panel-header">
          <h3><i class="fas fa-book-open"></i> ‡∏Ñ‡∏•‡∏±‡∏á‡∏ö‡∏ó</h3>
        </div>
        <div class="chapters-grid" id="chaptersGrid">
          <!-- Chapter Card Template -->
          <div class="chapter-card template">
            <input type="text" class="chapter-title" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏ó">
            <textarea class="chapter-summary" placeholder="‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ö‡∏ó"></textarea>
            <div class="chapter-meta">
              <div class="chapter-stats">
                <span><i class="fas fa-clock"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠: ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</span>
                <span><i class="fas fa-edit"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏µ‡πâ</span>
              </div>
              <div class="chapter-actions">
                <button class="btn-edit">
                  <i class="fas fa-edit"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                </button>
                <button class="btn-delete">
                  <i class="fas fa-trash"></i> ‡∏•‡∏ö
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Characters Module -->
      <div class="content-panel" id="characters-panel">
        <div class="panel-header">
          <h3><i class="fas fa-users"></i> ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£</h3>
        </div>
        <div class="characters-grid" id="charactersGrid">
        </div>
      </div>

      <!-- World Module -->
      <div class="content-panel" id="world-panel">
        <div class="panel-header">
          <h3><i class="fas fa-globe"></i> ‡πÇ‡∏•‡∏Å</h3>
        </div>
        <div class="world-grid" id="worldGrid">
          <!-- Location Card Template -->
          <div class="location-card template">
            <input type="text" class="location-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà">
            <textarea class="location-description" placeholder="‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà"></textarea>
            <button class="btn-delete">
              <i class="fas fa-trash"></i> ‡∏•‡∏ö
            </button>
          </div>
        </div>
      </div>

      <!-- Structure Module -->
      <div class="content-panel" id="structure-panel">
        <div class="panel-header">
          <h3><i class="fas fa-sitemap"></i> ‡πÇ‡∏Ñ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</h3>
        </div>
        <div class="structure-container">
          <!-- Structure content will be added via CSS/JS modules -->
        </div>
      </div>

      <!-- Research Module -->
      <div class="content-panel" id="research-panel">
        <div class="panel-header">
          <h3><i class="fas fa-search"></i> ‡∏ß‡∏¥‡∏à‡∏±‡∏¢</h3>
        </div>
        <div class="research-grid" id="researchGrid">
          <!-- Research Card Template -->
          <div class="research-card template">
            <input type="text" class="research-title" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢">
            <textarea class="research-content" placeholder="‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢"></textarea>
            <input type="text" class="research-source" placeholder="‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏≤">
            <button class="btn-delete">
              <i class="fas fa-trash"></i> ‡∏•‡∏ö
            </button>
          </div>
        </div>
      </div>

      <!-- Archive Module -->
      <div class="content-panel" id="archive-panel">
        <div class="panel-header">
          <h3><i class="fas fa-archive"></i> ‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î</h3>
        </div>
        <div class="archive-grid">
          <div class="archive-item">
            <i class="fas fa-box-open"></i>
            <h3>‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î‡∏¢‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤</h3>
            <p>‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Indicator -->
  <div class="loading-indicator" id="loadingIndicator" style="display: none;">
    <i class="fas fa-spinner fa-spin"></i>
    <span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏î‡πâ‡∏ß‡∏¢ AI...</span>
  </div>

  <!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
  
  <!-- JavaScript Modules -->
  <script src="src/utils/utils.js"></script>
  <script src="src/utils/firebase-manager.js"></script>
  <script src="src/utils/undo-redo.js"></script>
  <script src="src/modules/characters/character.js"></script>
  <script src="src/modules/writing/writing.js"></script>
  <script src="src/modules/chapters/chapter-preview.js"></script>
  <script src="src/core/app.js"></script>
</body>
</html>
